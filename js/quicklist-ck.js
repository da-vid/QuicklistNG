window.addEventListener&&window.addEventListener("load",function(){FastClick.attach(document.body)},!1);angular.module("quicklist",["firebase","linkify","ui.sortable","mgcrea.ngStrap","ngAnimate"]).factory("listName",["$firebase",function(e){var t=new Firebase("https://qwiklist.firebaseio.com/listAttrs/"+getListID()+"/listName");return e(t)}]).factory("listAttrs",["$firebase",function(e){var t=new Firebase("https://qwiklist.firebaseio.com/listAttrs/"+getListID());return e(t)}]).controller("listController",["$scope","$firebase","$modal","listName","listAttrs",function(e,t,n,r,i){function d(){v();e.listName.$set(e.listName.$value);y()}function v(){if(e.offline){Firebase.goOnline();console.log("Went Online.");e.offline=!1}m()}function m(){clearTimeout(u);u=setTimeout(g,o)}function g(){Firebase.goOffline();e.offline=!0;console.log("Went offline.")}function y(){e.listAttrs.$update({lastMod:Math.floor((new Date).getTime()/1e3)})}function b(){var t=!1,n=e.items.$getIndex();n.forEach(function(n,r){e.items[n].checked&&(t=!0)});e.checkedItemExists=t}function w(){b();e.$apply()}getListID();e.listName=r;e.listAttrs=i;var s=new Firebase("https://qwiklist.firebaseio.com/lists/"+getListID());e.items=t(s);e.loaded=!1;e.title="blah";e.content="contentblah";e.checkedItemExists=!1;var o=108e5,u=setTimeout(g,o);e.offline=!1;if(!document.addEventListener){document.attachEvent("keydown",v);document.attachEvent("mousedown",v);document.attachEvent("mousemove",v);document.attachEvent("touchstart",v)}else{document.addEventListener("keydown",v);document.addEventListener("mousedown",v);document.addEventListener("mousemove",v);document.addEventListener("touchstart",v)}var a=n({scope:e,template:"shareModal.html",animation:"am-fade-and-slide-top",show:!1}),f=n({scope:e,template:"newListModal.html",animation:"am-fade-and-slide-top",show:!1}),l=n({scope:e,template:"deleteAllModal.html",animation:"am-fade-and-slide-top",show:!1}),c=n({scope:e,template:"tosModal.html",animation:"am-fade-and-slide-top",show:!1});e.moreThanWhitespace=/\S/;e.defaultPageTitle="qList.cc | quick lists";e.listNameFocused=!1;var h="my qList",p="name your list here";e.listNamePlaceholder=h;e.pageURL=document.location.href;e.pageDisplayURL=document.location.hostname+document.location.pathname;e.sortableOptions={start:function(e,t){v()},handle:".gripper",disabled:!1,containment:".main"};e.addItem=function(){v();e.addItemForm.addItemBox.$valid&&s.child(e.nextItemID()).setWithPriority({ID:e.nextItemID(),name:e.itemName,checked:!1},e.nextPriority());e.itemName="";y()};e.deleteItem=function(t){v();var n=e.items.$getIndex();n.forEach(function(n,r){e.items[n].ID===t&&e.items.$remove(n)});y();b()};e.deleteAllChecked=function(){v();var t=e.items.$getIndex();t.forEach(function(t,n){e.items[t].checked&&e.items.$remove(t)});y();e.checkedItemExists=!1};e.checkItem=function(t){v();t.checked=!t.checked;e.items.$save();y();b()};e.items.$on("loaded",function(){e.loaded=!0;setTimeout(w,500)});e.getListName=function(){return e.listName.$value?e.listName.$value:e.defaultPageTitle};e.titleBoxFocus=function(){e.listNamePlaceholder=p;e.listNameFocused=!0};e.titleBoxBlur=function(){e.listNamePlaceholder=h;e.listNameFocused=!1;d()};e.nextItemID=function(){var t=0,n=e.items.$getIndex();n.forEach(function(n,r){e.items[n].ID>t&&(t=e.items[n].ID)});return t+1};e.nextPriority=function(){var t=0,n=e.items.$getIndex();n.forEach(function(n,r){e.items[n].$priority>t&&(t=e.items[n].$priority)});return t+1};e.fbCount=function(e){var t=0,n=e.$getIndex();n.forEach(function(e,n){t++});return t};e.showShareModal=function(){a.$promise.then(function(){a.show()})};e.showDeleteAllModal=function(){l.$promise.then(function(){l.show()})};e.showNewListModal=function(){e.showModal(f)};e.showTosModal=function(){e.showModal(c)};e.showModal=function(e){e.$promise.then(function(){e.show()})}}]).directive("selectOnClick",function(){return{restrict:"A",link:function(e,t,n){t.on("click",function(){this.select()})}}}).directive("selectPageBox",function(){return{restrict:"A",link:function(e,t,n){t.on("click",function(){document.getElementById("pageBox").select()})}}});